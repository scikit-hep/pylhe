---
title: "pylhe: A Lightweight Python interface to Les Houches Event files"
tags:
  - Python
  - physics
  - high energy physics
authors:
  - name: Alexander Puck Neuwirth^[Corresponding author.]
    orcid: 0000-0002-2484-1328
    affiliation: "1, 2"
  - name: Matthew Feickert
    orcid: 0000-0003-4124-7862
    affiliation: 3
  - name: Lukas Heinrich
    orcid: 0000-0002-4048-7584
    affiliation: 4
  - name: Eduardo Rodrigues
    orcid: 0000-0003-2846-7625
    affiliation: 5

affiliations:
  - name: University of Milan Bicocca
    index: 1
  - name: INFN Milan Bicocca
    index: 2
  - name: University of Wisconsin-Madison
    index: 3
  - name: Technical University of Munich
    index: 4
  - name: University of Liverpool
    index: 5

date: 26 November 2025 # APN TODO: update date
bibliography: paper.bib
---

# Summary

It allows for a simple exchange of generated events between different generators and analysis programs.

Historically, one of the first standards for event representation in high-energy physics was the HEPEVT common block [@Boos:2001cv], which provided a Fortran-based structure for storing event information.
As the complexity of simulations increased, the need for a more flexible and extensible format led to the development of the Les Houches Event File (LHEF) format [@Alwall:2006yp].
LHEF introduced an XML-like structure that allowed for better organization of event data and facilitated interoperability between different Monte Carlo event generators.
Typically, LHE files are used to describe parton-level events generated by matrix element generators before they are passed to parton shower and hadronization programs producing HepMC files [@Dobbs:2001ck;@Verbytskyi:2020sus].
In contrast to LHE files HepMC stores less details about the particles, but also contain many more particles.
Both files are plain text-based formats, making them human-readable but potentially large in size.
Hence, compression using gzip is common practice for both formats.
In the future a binary format such as HDF5 [@hdf5] could be considered for event storage to improve read/write performance and reduce file sizes further.


The LHE Format is XML-like where the free text in the `<init>` and `<event>` block is designed to be easily parsed in Fortran, with values separated by whitespace.
The `<header>` block can contain arbitrary XML content, usually metadata or comments explaining how the events were generated.

```xml
<LesHouchesEvents version="1.0">
<header></header>
<init>
beamA beamB energyA energyB PDFgroupA PDFgroupB PDFsetA PDFsetB weightingStrategy numProcesses
xSection error crosssectionmaximum procId
</init>
<event>
nparticles pid weight scale aqed aqcd
id status mother1 mother2 color1 color2 px py pz E m lifetime spin
...
</event>
...
</LesHouchesEvents>
```

<!-- APN TODO: check that we use the same name as in pylhe here!!! -->

Below we give a table summarizing the main parameters found in LHE files.

| Parameter | Type | Description | Unit |
|-----------|------|-------------|------|
| **Init block** | | | |
| beamA | int | PDG ID of first beam particle | - |
| beamB | int | PDG ID of second beam particle | - |
| energyA | float | Energy of first beam particle | GeV |
| energyB | float | Energy of second beam particle | GeV |
| PDFgroupA | int | PDF group ID for first beam | - |
| PDFgroupB | int | PDF group ID for second beam | - |
| PDFsetA | int | PDF set ID for first beam | - |
| PDFsetB | int | PDF set ID for second beam | - |
| weightingStrategy | int | Weighting strategy | - |
| numProcesses | int | Number of processes | - |
| xSection | float | Cross section | pb |
| error | float | Cross section uncertainty | pb |
| crosssectionmaximum | float | Maximum cross section | pb |
| procId | int | Process ID | - |
| **Event block** | | | |
| nparticles | int | Number of particles in event | - |
| pid | int | Process ID for this event | - |
| weight | float | Event weight | - |
| scale | float | Factorization/renormalization scale | GeV |
| aqed | float | QED coupling constant | - |
| aqcd | float | QCD coupling constant | - |
| **Particle entries** | | | |
| id | int | PDG particle ID | - |
| status | int | Particle status code | - |
| mother1 | int | Index of first mother particle | - |
| mother2 | int | Index of second mother particle | - |
| color1 | int | First color line index | - |
| color2 | int | Second color line index | - |
| px | float | x-component of momentum | GeV |
| py | float | y-component of momentum | GeV |
| pz | float | z-component of momentum | GeV |
| E | float | Energy | GeV |
| m | float | Mass | GeV |
| lifetime | float | Proper lifetime | mm/c |
| spin | float | Spin information | - |

Further details can be found in the original definition of the Les Houches Event File standard in [@Alwall:2006yp].

Besides the original publication there were two extensions to the LHE format, version 2.0 in 2009 [@Butterworth:2010ym] and version 3.0 in 2012 [@Andersen:2014efa].

<!-- APN TODO: mention what different version of lhe files 1.0 vs 3.0 -->

# Statement of need

The format is used by all major Monte Carlo event generators such as MadGraph [@Alwall:2014hca], POWHEG-BOX [@Nason:2004rx;@Frixione:2007vw;@Alioli:2010xd], Sherpa [@Gleisberg:2008ta;@Sherpa:2019gpd], HERWIG [@Corcella:2000bw;@Bahr:2008pv;@Bellm:2015jjp;@Bellm:2019zci;@Bewick:2023tfi], Pythia [@Sjostrand:2006za;@Sjostrand:2007gs;@Sjostrand:2014zea;@Bierlich:2022pfr], Whizard [@Kilian:2007gr;@Moretti:2001zz].
They produce hard scattering events in the LHE format which are then passed to parton shower and hadronization programs or directly to analysis frameworks.

`pylhe` allows for easy reading and writing of LHE files in Python, enabling seamless integration into modern pythonic data analysis workflows in high-energy physics.
<!-- APN TODO: cite and mention awkward integration -->
The library facilitates quick validation of event files through programmatic access to event structure and particle properties, making it straightforward to perform sanity checks on generated events.
Additionally, `pylhe` serves as a crucial interface for uprising machine learning applications in particle physics, allowing researchers to efficiently extract and preprocess event data for training neural networks and other ML models used in event classification, anomaly detection, and physics analysis.

## Impact

`pylhe` has already been used in various research projects and publications within the high-energy physics.
It has been cited in Higgs studies [@Brehmer:2019gmn;@Stylianou:2023tgg;@Feuerstake:2024uxs], SUSY / BSM / dark matter searches [@Beresford:2018pbt;@Kling:2020iar;@Anisha:2023xmh;@Zhou:2022jgj;@Zhou:2024fjf;@Cheung:2024oxh;@Beresford:2024dsc], forward physics [@Kling:2022ykt;@Kelly:2021mcd;@Kling:2020mch], but also in methodological studies involving machine learning techniques for event generation and analysis [@Brehmer:2019xox;@Kofler:2024efb].

# Acknowledgements

We would additionally like to thank the contributors of pylhe and the Scikit-HEP community for their support.

# References
