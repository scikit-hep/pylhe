---
title: "pylhe: A Lightweight Python interface to Les Houches Event files"
tags:
  - Python
  - physics
  - high energy physics
authors:
  - name: Alexander Puck Neuwirth^[Corresponding author.]
    orcid: 0000-0002-2484-1328
    affiliation: "1, 2"
  - name: Matthew Feickert
    orcid: 0000-0003-4124-7862
    affiliation: 3
  - name: Lukas Heinrich
    orcid: 0000-0002-4048-7584
    affiliation: 4
  - name: Eduardo Rodrigues
    orcid: 0000-0003-2846-7625
    affiliation: 5

affiliations:
  - name: University of Milan Bicocca
    index: 1
  - name: INFN Milan Bicocca
    index: 2
  - name: University of Wisconsin-Madison
    index: 3
  - name: Technical University of Munich
    index: 4
  - name: University of Liverpool
    index: 5

date: 11 February 2026 # APN TODO: update date
bibliography: paper.bib
---

# Summary

`pylhe` is a lightweight Python library that provides a simple interface for reading and writing Les Houches Event (LHE) files, a standard format used by Monte Carlo event generators in high-energy physics.
The library enables memory-efficient streaming of events from `.lhe` and `.lhe.gz` files through a pythonic iterator interface, allowing researchers to process arbitrarily large event files without loading all events into memory simultaneously.
`pylhe` supports widely-adopted LHE format extensions including multiple weights via `<rwgt>` and `<weights>` tags, building upon the original LHE standard [@Alwall:2006yp] and its subsequent extensions [@Butterworth:2010ym;@Andersen:2014efa].
The library fills a crucial gap in the Python ecosystem by providing the first lightweight, dedicated interface for LHE files, complementing existing interfaces embedded within Monte Carlo generators.

# Statement of need

The LHE format is used by all major Monte Carlo event generators such as MadGraph [@Alwall:2014hca], POWHEG-BOX [@Nason:2004rx;@Frixione:2007vw;@Alioli:2010xd], Sherpa [@Gleisberg:2008ta;@Sherpa:2019gpd], HERWIG [@Corcella:2000bw;@Bahr:2008pv;@Bellm:2015jjp;@Bellm:2019zci;@Bewick:2023tfi], Pythia [@Sjostrand:2006za;@Sjostrand:2007gs;@Sjostrand:2014zea;@Bierlich:2022pfr], Whizard [@Kilian:2007gr;@Moretti:2001zz].
While interfaces for C/C++/Fortran exist in the respective generators, a lightweight and easy-to-use Python interface was missing until the inception of `pylhe` in 2015.
Additionally, `pylhe` can serve as a crucial interface for emerging machine learning applications in particle physics, allowing researchers to efficiently extract event data for training neural networks and other machine learning models used in event classification, anomaly detection, and physics analysis.

# State of the field

Historically, the first standards for event representation in high-energy physics were the HEPEVT and HEPRUP common blocks [@Boos:2001cv], which provided a Fortran-based structure for storing event information.
As the complexity of Monte Carlo event generators increased, the need for a more flexible and extensible format led to the development of the LHE file format [@Alwall:2006yp].
LHE introduced an XML structure that allowed for better organization of event data and facilitated interoperability between different tools.
Typically, LHE files are used to describe parton-level events generated by matrix element generators that are passed to parton shower and hadronization programs producing HepMC files [@Dobbs:2001ck;@Verbytskyi:2020sus;@hans_dembinski_2022_7013498], or directly to analysis frameworks such as Rivet [@Buckley:2010ar;@Bierlich:2019rhm;@Bierlich:2024vqo].
In contrast to LHE files, HepMC stores fewer details about the particles, but also contains many more particles per event.
Both files are plain text-based formats, making them human-readable but potentially large.
Consequently, compression using gzip is common practice for both formats.
In the future a binary format such as HDF5 [@hdf5] could be considered for event storage to improve read/write performance and reduce file sizes further.

The LHE format stores information within `<init>` and multiple `<event>` blocks consisting of whitespace-separated values designed historically for straightforward parsing in Fortran.
Further details can be found in the original definition of the Les Houches Event file standard [@Alwall:2006yp].
Following the original publication there were two extensions to the LHE format, version 2.0 in 2009 [@Butterworth:2010ym] and version 3.0 in 2013 [@Andersen:2014efa].
However, `pylhe` currently only implements the widely adopted extension on top of version 1.0, that is the addition of multiple weights via `<initrwgt>`, `<rwgt>`, `<weight>`, `<weights>`, `<wgt>`, and `<weightgroup>`.
In the future, if there is a demand for `<scales>`, `<generator>`, `<pdfinfo>`, or `<clustering>`, support for these can be added as well.

# Software design

`pylhe` allows for easy reading and writing of `.lhe` and `.lhe.gz` files in Python, enabling seamless integration into modern data analysis workflows in high-energy physics.
The pythonic event yielding approach allows for memory-efficient processing of arbitrarily large LHE files by streaming events one at a time rather than loading all of them at once into memory.
The library facilitates quick validation of event files through programmatic access to event structure and particle properties, making it straightforward to perform sanity checks on generated events.
This can be done for example via the integration with Awkward Array [@Pivarski_Awkward_Array_2018] through the `to_awkward()` function, which converts LHE events into columnar data structures optimized for vectorized operations and efficient analysis of large datasets.

# Research impact statement

`pylhe` has already been used in various research projects and publications within high-energy physics.
It has been cited in Higgs studies [@Brehmer:2019gmn;@Stylianou:2023tgg;@Feuerstake:2024uxs], SUSY / BSM / dark matter searches [@Beresford:2018pbt;@Kling:2020iar;@Anisha:2023xmh;@Zhou:2022jgj;@Zhou:2024fjf;@Cheung:2024oxh;@Beresford:2024dsc], forward physics [@Kling:2022ykt;@Kelly:2021mcd;@Kling:2020mch], but also in methodological studies involving machine learning techniques for event generation and analysis [@Brehmer:2019xox;@Kofler:2024efb].

# AI usage disclosure

Generative AI tools have been used in the development of this software and writing of the manuscript:

- Github's copilot has been used in reviewing pull requests.
- VScode's copilot has been used as an advanced autocomplete.
- ChatGPT has been used to identify the most pythonic solutions in case of ambiguity.

All the results generated by these tools have been reviewed by the authors and are correct to the best of our knowledge.

# Acknowledgements

We would additionally like to thank the contributors of pylhe and the Scikit-HEP community for their support.

# References
